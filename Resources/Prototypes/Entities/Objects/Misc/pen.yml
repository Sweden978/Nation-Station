- type: entity
  name: pen
  parent: BaseItem
  id: Pen
  description: A dark ink pen.
  components:
  - type: Sprite
    sprite: Objects/Misc/pens.rsi
    state: pen
  - type: Item
    sprite: Objects/Misc/pens.rsi
    heldPrefix: pen
    size: Tiny
  - type: Tag
    tags:
    - Write
    - Pen
  - type: PhysicalComposition
    materialComposition:
      Steel: 25
  - type: EmitSoundOnUse
    sound:
      path: /Audio/Items/pen_click.ogg
      params:
        volume: -4
        maxDistance: 2
  - type: UseDelay
    delay: 1.5

- type: entity
  parent: Pen
  id: PenEmbeddable
  abstract: true
  components:
  - type: EmbeddableProjectile
    offset: 0.3,0.0
    removalTime: 0.0
  - type: ThrowingAngle
    angle: 315
  - type: LandAtCursor
  - type: DamageOtherOnHit
    damage:
      types:
        Piercing: 3

#TODO: I want the luxury pen to write a cool font like Merriweather in the future.

- type: entity
  name: luxury pen
  parent: Pen
  id: LuxuryPen
  description: A fancy and expensive pen that you only deserve to own if you're qualified to handle vast amounts of paperwork.
  components:
  - type: Sprite
    state: luxury_pen
  - type: Item
    heldPrefix: luxury_pen

- type: entity
  id: BaseAdvancedPen
  parent: PenEmbeddable
  abstract: true
  components:
  - type: Tag
    tags:
    - Write
    - WriteIgnoreStamps
    - Pickaxe
    - Pen
  - type: MeleeWeapon
    wideAnimationRotation: -45
    damage:
      types:
        Piercing: 15
    soundHit:
      path: /Audio/Weapons/bladeslice.ogg
  - type: Tool
    qualities:
    - Screwing
    useSound:
      collection: Screwdriver

- type: entity
  name: Cybersun pen
  parent: [BaseAdvancedPen, BaseSyndicateContraband]
  id: CyberPen
  description: A high-tech pen straight from Cybersun's legal department, capable of refracting hard-light at impossible angles through its diamond tip in order to write. So powerful, it's even able to rewrite officially stamped documents should the need arise.
  components:
  - type: Sprite
    state: overpriced_pen
  - type: Item
    heldPrefix: overpriced_pen

- type: entity
  name: CentComm pen
  parent: [BaseAdvancedPen, BaseCentcommContraband]
  id: PenCentcom
  description: In an attempt to keep up with the "power" of the cybersun bureaucracy, NT made a replica of cyber pen, in their corporate style.
  components:
  - type: Sprite
    state: pen_centcom
  - type: Item
    heldPrefix: pen_centcom

- type: entity
  name: captain's fountain pen
  parent: PenEmbeddable
  id: PenCap
  description: A luxurious fountain pen for the captain of the station.
  components:
  - type: Sprite
    state: pen_cap

- type: entity
  name: hop's fountain pen
  parent: PenEmbeddable
  id: PenHop
  description: A luxurious fountain pen for the hop of the station.
  components:
  - type: Sprite
    state: pen_hop

- type: entity
  name: hos's fountain pen
  parent: PenEmbeddable
  id: PenHos
  description: A luxurious fountain pen for the hos of the station. Has a built in stun module.
  components:
  - type: Sprite
    state: pen_hos
  - type: Stunbaton
    energyPerUse: 50
  - type: ItemToggle
    predictable: false
    soundActivate:
      collection: sparks
      params:
        variation: 0.250
    soundDeactivate:
      collection: sparks
      params:
        variation: 0.250
    soundFailToActivate:
      path: /Audio/Machines/button.ogg
      params:
        variation: 0.250
  - type: ItemToggleMeleeWeapon
    activatedDamage:
      types:
        Piercing: 0
  - type: MeleeWeapon
    wideAnimationRotation: -135
    damage:
      types:
        Piercing: 10
    bluntStaminaDamageFactor: 2.0
    angle: 60
    animation: WeaponArcThrust
  - type: StaminaDamageOnHit
    damage: 101
    sound: /Audio/Weapons/Guns/Hits/taser_hit.ogg
  - type: StaminaDamageOnCollide
    damage: 101
    sound: /Audio/Weapons/Guns/Hits/taser_hit.ogg
  - type: LandAtCursor # it deals stamina damage when thrown
  - type: Battery
    maxCharge: 100
    startingCharge: 100
  - type: UseDelay
  - type: Item
    heldPrefix: off
    size: Normal
  - type: DisarmMalus
    malus: 0.225
  - type: StaticPrice
    price: 80
  - type: Riggable
  - type: SolutionContainerManager
    solutions:
      battery:
        maxVol: 5
  - type: InjectableSolution
    solution: battery
  - type: DrawableSolution
    solution: battery
  - type: Explosive
    explosionType: Default
    intensitySlope: 1.5
    maxIntensity: 200
  - type: PhysicalComposition
    materialComposition:
      Steel: 100
      Plastic: 100
  - type: GuideHelp
    guides:
    - Security
    - Antagonists
  - type: EmbeddableProjectile
    minimumSpeed: 3
    removalTime: 0.5
    offset: 0.0,0.0
  - type: ThrowingAngle
    angle: 315
  - type: BalloonPopper


- type: entity
  name: ce's fountain pen
  parent: PenEmbeddable
  id: PenCe
  description: A luxurious fountain pen for the ce of the station. It also works as a screwdriver.
  components:
  - type: Sprite
    state: pen_ce
  - type: Tool
    qualities:
    - Screwing
    useSound:
      collection: Screwdriver

- type: entity
  name: cmo's fountain pen
  parent: PenEmbeddable
  id: PenCmo
  description: A luxurious fountain pen for the Cmo of the station. It has a hidden autoinjector inside.
  components:
  - type: Sprite
    state: pen_cmo
  - type: SolutionContainerManager
    solutions:
      hypospray:
        maxVol: 10
  - type: RefillableSolution
    solution: hypospray
  - type: ExaminableSolution
    solution: hypospray
    heldOnly: true # Allow examination only when held in hand.
  - type: Hypospray
    onlyAffectsMobs: false
  - type: UseDelay
    delay: 0.5
  - type: StaticPrice # A new shitcurity meta
    price: 75
  - type: EmitSoundOnUse
    handle: false # don't want the sound to stop the self-inject from triggering

- type: entity
  name: qm's fountain pen
  parent: PenEmbeddable
  id: PenQm
  description: A luxurious fountain pen for the qm of the station.
  components:
  - type: Sprite
    state: pen_qm
  - type: Item
    sprite: Objects/Tools/appraisal-tool.rsi
  - type: PriceGun
  - type: UseDelay
    delay: 3
  - type: Clothing
    sprite: Objects/Tools/appraisal-tool.rsi
    quickEquip: false
    slots:
    - Belt
  - type: PhysicalComposition
    materialComposition:
      Steel: 250
  - type: Tag
    tags:
    - AppraisalTool
    - Sidearm
  - type: GuideHelp
    guides:
    - Cargo

- type: entity
  name: rd's fountain pen
  parent: PenEmbeddable
  id: PenRd
  description: A luxurious fountain pen for the Rd of the station.
  components:
  - type: Sprite
    state: pen_rd
  - type: Appearance
  - type: GenericVisualizer
    visuals:
      enum.ToggleVisuals.Toggled:
        enum.ToggleVisuals.Layer:
          True: { visible: true }
          False: { visible: false }
  - type: ItemToggle
  - type: ProximityBeeper
  - type: ProximityDetector
    range: 20
    criteria:
      components:
      - Anomaly
  - type: Beeper
    minBeepInterval: 0.15
    maxBeepInterval: 1.00
    beepSound:
      path: "/Audio/Items/locator_beep.ogg"
      params:
        maxDistance: 1
        volume: -8